<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>CoolestProjects</title>

    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- Makes your prototype chrome-less once bookmarked to your phone's home screen -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Set Apple icons for when prototype is saved to home screen -->
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="img/favicons/apple-touch-icon-57x57.png">

    <!-- Include the compiled Ratchet CSS -->
    <link rel="stylesheet" href="css/ratchet.css">

    <!-- Include the compiled Ratchet JS -->
    <script src="js/ratchet.js"></script>
</head>

<body>

    <!-- Make sure all your bars are the first things in your <body> -->
    <header class="bar-title">
        <a class="button" href="home.html" data-transition="fade">
          Home
        </a>
        <h1 class="title">Voting</h1>
        <a class="button" href="logout.html" data-transition="fade" >
          Logout
        </a>
    </header>

    <!-- Wrap all non-bar HTML in the .content div (this is actually what scrolls) -->
    <div class="content content-padded">
        <a href="#" id="scan" class="button-main button-block" role="button">
            Scan
        </a>
        <div id="info">
        </div>
    </div>

    <script src="cordova.js"></script>
    <script src="barcodescanner.js"></script>
    <script src="childbrowser.js"></script>
    <script>
    var app = {
    initialize: function() {
        this.bindEvents();
    },

    bindEvents: function() {
        document.addEventListener('deviceready', this.onDeviceReady, false);
        document.getElementById('scan').addEventListener('click', this.scan, false);
    },

    onDeviceReady: function() {
        app.receivedEvent('deviceready');
    },

    receivedEvent: function(id) {
        var parentElement = document.getElementById(id);
        var listeningElement = parentElement.querySelector('.listening');
        var receivedElement = parentElement.querySelector('.received');

        listeningElement.setAttribute('style', 'display:none;');
        receivedElement.setAttribute('style', 'display:block;');

        console.log('Received Event: ' + id);
    },
    scan: function() {
        console.log('scanning');
        var scanner = cordova.require("cordova/plugin/BarcodeScanner");
        try {
            scanner.scan(function(args) {
                console.log("Scanner result: \n" +
                    "text: " + args.text + "\n" +
                    "format: " + args.format + "\n" +
                    "cancelled: " + args.cancelled + "\n");
                /*
                if (args.format == "QR_CODE") {
                    window.plugins.childBrowser.showWebPage(args.text, { showLocationBar: false });
                }
                */
                document.getElementById("info").innerHTML = args.text;
                console.log(args);
        });
        } catch (ex) {
            console.log(ex.message);
        }
    }

};     
    </script>
</body>

</html>
